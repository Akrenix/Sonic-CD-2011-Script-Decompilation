//------------Sonic CD UFONode Script-------------//
//--------Scripted by Christian Whitehead 'The Taxman'--------//
//-------Unpacked By Rubberduckycooly's Script Unpacker-------//

//-------Aliases-------//
#alias 5: TYPE_UFONODE


function Sonic_Function0
	if Options.AttractMode==0
		if Player.ControlMode==0
			if Object[9].Type==TypeName[BlankObject]
				if KeyPress.Start==1
					KeyPress.Start=0
					if Options.DevMenuFlag==1
						Stage.State=STAGE_PAUSED
						PauseMusic()
						PlaySfx(27,0)
						StopSfx(24)
						StopSfx(25)
						Object[9].Type=TypeName[PauseMenu]
						Object[9].DrawOrder=6
						Object[9].Priority=2
						TileLayer[0].Type=3
					else
						EngineCallback(13)
					endif
				endif
			endif
		endif
		ProcessPlayerControl()
	endif
endfunction


function Sonic_Function1
	if Options.AttractMode==0
		if Player.ControlMode==0
			if Object[9].Type==TypeName[BlankObject]
				if KeyPress.Start==1
					KeyPress.Start=0
					if Options.DevMenuFlag==1
						Stage.State=STAGE_PAUSED
						PauseMusic()
						PlaySfx(27,0)
						StopSfx(24)
						StopSfx(25)
						Object[9].Type=TypeName[PauseMenu]
						Object[9].DrawOrder=6
						Object[9].Priority=2
						TileLayer[0].Type=3
					else
						EngineCallback(13)
					endif
				endif
			endif
		endif
	endif
endfunction


function Sonic_Function2
	if Player.Left==1
		Object.Value7--
		if Object.Value7<-8
			Object.Value7=-8
		endif
	else
		if Player.Right==1
			Object.Value7++
			if Object.Value7>8
				Object.Value7=8
			endif
		else
			if Object.Value7>0
				Object.Value7--
			endif
			if Object.Value7<0
				Object.Value7++
			endif
		endif
	endif
	if Player.Left==1
		Player.Angle+=2
	endif
	if Player.Right==1
		Player.Angle-=2
	endif
	if Player.Angle<0
		Player.Angle+=512
	endif
	Player.Angle&=511
	Sin(TempValue0,Player.Angle)
	TempValue0*=Player.Speed
	TempValue0>>=9
	Player.XPos+=TempValue0
	Cos(TempValue0,Player.Angle)
	TempValue0*=Player.Speed
	TempValue0>>=9
	Object.Value0+=TempValue0
endfunction


function Sonic_Function3
	Object.Value3+=Object.AnimationSpeed
	if Object.Value3>239
		Object.Value3-=240
		Object.Frame++
		if Object.Frame>Object.Value2
			Object.Frame=Object.Value1
		endif
	endif
endfunction


function Sonic_Function4
	TempValue2=0
	TempValue0-=8
	TempValue1-=8
	Get16x16TileInfo(CheckResult,TempValue0,TempValue1,6)
	if CheckResult==3
		SetBit(TempValue2,0,1)
	endif
	TempValue0+=16
	Get16x16TileInfo(CheckResult,TempValue0,TempValue1,6)
	if CheckResult==3
		SetBit(TempValue2,1,1)
	endif
	TempValue0-=16
	TempValue1+=16
	Get16x16TileInfo(CheckResult,TempValue0,TempValue1,6)
	if CheckResult==3
		SetBit(TempValue2,2,1)
	endif
	TempValue0+=16
	Get16x16TileInfo(CheckResult,TempValue0,TempValue1,6)
	if CheckResult==3
		SetBit(TempValue2,3,1)
	endif
	if TempValue2>0
		TempValue3=Player.Speed
		TempValue3+=65536
		if Object.Value6!=32
			PlayStageSfx(2,0)
		endif
		Object.Value6=32
		switch TempValue2
		case 1
			Player.ScreenXPos=TempValue3
			Player.ScreenYPos=TempValue3
			break
		case 2
			Player.ScreenXPos=TempValue3
			Player.ScreenYPos=TempValue3
			FlipSign(Player.ScreenXPos)
			break
		case 3
			Player.ScreenXPos=0
			Player.ScreenYPos=TempValue3
			break
		case 4
			Player.ScreenXPos=TempValue3
			Player.ScreenYPos=TempValue3
			FlipSign(Player.ScreenYPos)
			break
		case 5
			Player.ScreenXPos=TempValue3
			Player.ScreenYPos=0
			break
		case 6
		case 7
			Player.ScreenXPos=TempValue3
			Player.ScreenYPos=TempValue3
			break
		case 8
		case 14
		case 15
			Player.ScreenXPos=TempValue3
			Player.ScreenYPos=TempValue3
			FlipSign(Player.ScreenXPos)
			FlipSign(Player.ScreenYPos)
			break
		case 9
		case 11
			Player.ScreenXPos=TempValue3
			Player.ScreenYPos=TempValue3
			FlipSign(Player.ScreenXPos)
			break
		case 10
			Player.ScreenXPos=TempValue3
			Player.ScreenYPos=0
			FlipSign(Player.ScreenXPos)
			break
		case 12
			Player.ScreenXPos=0
			Player.ScreenYPos=TempValue3
			FlipSign(Player.ScreenYPos)
			break
		case 13
			Player.ScreenXPos=TempValue3
			Player.ScreenYPos=TempValue3
			FlipSign(Player.ScreenYPos)
			break

		endswitch
	endif
endfunction


function Sonic_Function5
	TempValue0=Player.XPos
	TempValue0>>=16
	TempValue1=Object.Value0
	TempValue1>>=16
	CallFunction(Sonic_Function4)
	TempValue0=Player.XPos
	TempValue0>>=16
	TempValue1=Object.Value0
	TempValue1>>=16
	Get16x16TileInfo(CheckResult,TempValue0,TempValue1,6)
	switch CheckResult
	case 1
		Object[3].Type=TypeName[DustPuff]
		Object[3].DrawOrder=4
		if Object[4].Value5==0
			if Player.Speed>163840
				Player.Speed=163840
			endif
		else
			if Player.Speed>327680
				Player.Speed=327680
			endif
		endif
		break
	case 2
		Object[3].Type=TypeName[WaterSplash]
		Object[3].DrawOrder=4
		Object[3].Value5=22526
		if Object[4].Value5>0
			if Player.Speed>327680
				Player.Speed=327680
			endif
		endif
		break
	case 4
		Object.State=6
		Object.Value6=136
		Object.Frame=54
		Object.Value1=54
		Object.Value2=76
		Object.AnimationSpeed=40
		Object.Value3=0
		Player.Speed=65536
		if Object[4].Value3>0
			PlaySfx(4,0)
			TempValue0=Object[4].Value3
			Object[4].Value3>>=1
			TempValue0-=Object[4].Value3
			if TempValue0>8
				TempValue0=8
			endif
			while TempValue0>0
				CreateTempObject(TypeName[Ring],0,Player.XPos,0)
				Object[TempObjectPos].Priority=1
				Object[TempObjectPos].Value0=Object.Value0
				Rand(TempValue1,64)
				TempValue1-=32
				TempValue1<<=10
				Object[TempObjectPos].Value1=TempValue1
				Sin(TempValue1,Player.Angle)
				TempValue1*=96
				Object[TempObjectPos].Value1+=TempValue1
				Rand(TempValue1,64)
				TempValue1+=32
				TempValue1<<=12
				Object[TempObjectPos].Value2=TempValue1
				Rand(TempValue1,64)
				TempValue1-=32
				TempValue1<<=10
				Object[TempObjectPos].Value3=TempValue1
				Cos(TempValue1,Player.Angle)
				TempValue1*=96
				Object[TempObjectPos].Value3+=TempValue1
				TempValue0--
			loop
		endif
		break
	case 5
		Object.State=11
		Object.Value6=0
		Object.Frame=39
		Object.Value1=39
		Object.Value2=42
		Object.AnimationSpeed=80
		Object.Value3=0
		Player.YVelocity=573440
		PlaySfx(11,0)
		break
	case 6
		Object.State=5
		Object.Value6=0
		Object.Frame=48
		Object.Value1=48
		Object.Value2=53
		Object.AnimationSpeed=24
		Object.Value3=0
		Player.YVelocity=163840
		PlayStageSfx(6,0)
		break
	case 7
		Object.Value6=40
		Player.ScreenXPos=-786432
		Player.ScreenYPos=0
		Get16x16TileInfo(CheckResult,TempValue0,TempValue1,1)
		if CheckResult==1
			FlipSign(Player.ScreenXPos)
		else
			if CheckResult==3
				FlipSign(Player.ScreenXPos)
			endif
		endif
		if Object.State!=4
			PlayStageSfx(3,0)
		endif
		Object.State=4
		Object.Frame=43
		Object.Value1=43
		Object.Value2=47
		Object.AnimationSpeed=24
		Object.Value3=0
		break
	case 8
		Object.Value6=40
		Player.ScreenXPos=786432
		Player.ScreenYPos=0
		Get16x16TileInfo(CheckResult,TempValue0,TempValue1,1)
		if CheckResult==1
			FlipSign(Player.ScreenXPos)
		else
			if CheckResult==3
				FlipSign(Player.ScreenXPos)
			endif
		endif
		if Object.State!=4
			PlayStageSfx(3,0)
		endif
		Object.State=4
		Object.Frame=43
		Object.Value1=43
		Object.Value2=47
		Object.AnimationSpeed=24
		Object.Value3=0
		break
	case 9
		Object.Value6=40
		Player.ScreenXPos=0
		Player.ScreenYPos=-786432
		Get16x16TileInfo(CheckResult,TempValue0,TempValue1,1)
		if CheckResult==2
			FlipSign(Player.ScreenYPos)
		else
			if CheckResult==3
				FlipSign(Player.ScreenYPos)
			endif
		endif
		if Object.State!=4
			PlayStageSfx(3,0)
		endif
		Object.State=4
		Object.Frame=43
		Object.Value1=43
		Object.Value2=47
		Object.AnimationSpeed=24
		Object.Value3=0
		break
	case 10
		Object.Value6=40
		Player.ScreenXPos=0
		Player.ScreenYPos=786432
		Get16x16TileInfo(CheckResult,TempValue0,TempValue1,1)
		if CheckResult==2
			FlipSign(Player.ScreenYPos)
		else
			if CheckResult==3
				FlipSign(Player.ScreenYPos)
			endif
		endif
		if Object.State!=4
			PlayStageSfx(3,0)
		endif
		Object.State=4
		Object.Frame=43
		Object.Value1=43
		Object.Value2=47
		Object.AnimationSpeed=24
		Object.Value3=0
		break
	case 11
		if Object.Value6!=16
			PlayStageSfx(4,0)
		endif
		Object.Value6=16
		Player.ScreenXPos=-524288
		Player.ScreenYPos=0
		Get16x16TileInfo(CheckResult,TempValue0,TempValue1,1)
		if CheckResult==1
			FlipSign(Player.ScreenXPos)
		else
			if CheckResult==3
				FlipSign(Player.ScreenXPos)
			endif
		endif
		break
	case 12
		if Object.Value6!=16
			PlayStageSfx(4,0)
		endif
		Object.Value6=16
		Player.ScreenXPos=524288
		Player.ScreenYPos=0
		Get16x16TileInfo(CheckResult,TempValue0,TempValue1,1)
		if CheckResult==1
			FlipSign(Player.ScreenXPos)
		else
			if CheckResult==3
				FlipSign(Player.ScreenXPos)
			endif
		endif
		break
	case 13
		if Object.Value6!=16
			PlayStageSfx(4,0)
		endif
		Object.Value6=16
		Player.ScreenXPos=0
		Player.ScreenYPos=-524288
		Get16x16TileInfo(CheckResult,TempValue0,TempValue1,1)
		if CheckResult==2
			FlipSign(Player.ScreenYPos)
		else
			if CheckResult==3
				FlipSign(Player.ScreenYPos)
			endif
		endif
		break
	case 14
		if Object.Value6!=16
			PlayStageSfx(4,0)
		endif
		Object.Value6=16
		Player.ScreenXPos=0
		Player.ScreenYPos=524288
		Get16x16TileInfo(CheckResult,TempValue0,TempValue1,1)
		if CheckResult==2
			FlipSign(Player.ScreenYPos)
		else
			if CheckResult==3
				FlipSign(Player.ScreenYPos)
			endif
		endif
		break

	endswitch
endfunction

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
